# [LeetCode] 122. Best Time to Buy and Sell Stock II(Medium)

- **Link:** [LeetCode Problem Link](https://leetcode.com/problems/best-time-to-buy-and-sell-stock-ii/description/?envType=study-plan-v2&envId=top-interview-150)
- **Tags:** `Array`, `Dynamic Programming`,`Greedy`
- **Difficulty:** Medium

## 題目解釋

會得到一個陣列 `prices` 其中 `price[i]` 代表第 `i` 天的股價，同一天當中可以賣出再買入，期間總共交易次數不限，但是一次只能持有一股股票，計算出這些天可能獲得的最大利潤。


## 解法思路

### 解法一：Greedy
> [!IMPORTANT]
> **思路：**
> 假設股價隨著時間變化是連續的波段，我們可以將長期的利潤分解為每一天的利潤總和，所以可能獲得的最大利潤就是把所有上漲獲得的利潤加總起來。
- **時間複雜度:** $O(n)$ - 只需歷遍陣列一次
- **空間複雜度:** $O(1)$ - 只用到常數個變數

```cpp=
class Solution {
public:
    int maxProfit(vector<int>& prices) {
        int profit = 0;
        for(int i=1;i < prices.size();i++){
            int diff = prices[i] - prices[i-1];
            if(diff > 0){
                profit += diff;
            }
        }
        return profit;
    }
};
```
### 解法二：DP
> [!IMPORTANT]
> **思路：**
> 分成兩種狀態來記錄:
> 1. 第 `i` 天結束之後持有股票
> `hold[i]`:第 `i` 天結束之後持有股票，此時的利潤
> 
> 2. 第 `i` 天結束之後沒有股票
> `not_hold[i]`:第 `i` 天結束之後沒有股票，此時的利潤
> 
> **狀態轉移：**
> * `hold[i]` 的來源有兩種可能，取最大值：
>   1. **延續持有**：昨天就持有，今天不做事 → `hold[i-1]`
>   2. **今日買入**：昨天沒持有，今天買入（扣除股價） → `not_hold[i-1] - prices[i]`
>
> * `not_hold[i]` 的來源也有兩種可能，取最大值：
>   1. **延續觀望**：昨天就沒持有，今天也不買 → `not_hold[i-1]`
>   2. **今日賣出**：昨天持有，今天賣掉（獲得股價） → `hold[i-1] + prices[i]`






- **時間複雜度:** $O(n)$ - 只需歷遍陣列一次
- **空間複雜度:** $O(n)$ - 會用到兩個長度為n的vector(可優化至 $O(1)$)

```cpp=
class Solution {
public:
    int maxProfit(vector<int>& prices) {
        int n = prices.size();
        vector<int> not_hold(n);
        //這一天結束之後手上沒有股票，獲得的利潤
        vector<int> hold(n);
        //這一天結束之後手上持有股票，獲得的利潤(要減去成本)
        not_hold[0] = 0;
        hold[0] = 0 - prices[0];    //第一天持有股票，要減去第一天的股價成本

        for(int i=1;i < prices.size();i++){
            not_hold[i] = max(not_hold[i-1], hold[i-1] + prices[i]);
            //第i天結束沒有股票，可能是第i-1天就沒有股票，或者是第i-1天時有股票但是今天賣掉了

            hold[i] = max(hold[i-1], not_hold[i-1] - prices[i]);
            //第i天結束持有股票，可能是第i-1天就持有股票，或者是第i-1天時沒有股票但是今天買了股票
        }
        return not_hold[n-1];   //最後一天一定是把股票賣掉利潤比較大
    }
};
```

